---
url: "https://docs.plasmo.com/framework/content-scripts-ui/life-cycle"
title: "Life Cycle of Plasmo CSUI – Plasmo"
---

[**_plasmo_**](https://docs.plasmo.com/)

`CTRL K`

[GitHubGitHub (opens in a new tab)](https://github.com/PlasmoHQ/plasmo) [DiscordDiscord (opens in a new tab)](https://www.plasmo.com/s/d)

`CTRL K`

- [Welcome](https://docs.plasmo.com/)
- Framework




- [Getting Started](https://docs.plasmo.com/framework)
- Workflows




- [New Extension](https://docs.plasmo.com/framework/workflows/new)
- [Development Server](https://docs.plasmo.com/framework/workflows/dev)
- [Production Build](https://docs.plasmo.com/framework/workflows/build)
- [Submission](https://docs.plasmo.com/framework/workflows/submit)
- [FAQ](https://docs.plasmo.com/framework/workflows/faq)

- [Extension Pages](https://docs.plasmo.com/framework/ext-pages)
- [Tab Pages](https://docs.plasmo.com/framework/tab-pages)
- [Sandbox Pages](https://docs.plasmo.com/framework/sandbox-pages)
- [Content Scripts](https://docs.plasmo.com/framework/content-scripts)
- [Content Scripts UI](https://docs.plasmo.com/framework/content-scripts-ui)




- [Life Cycle](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle)
- [Styling](https://docs.plasmo.com/framework/content-scripts-ui/styling)

- [Background SW](https://docs.plasmo.com/framework/background-service-worker)
- [Messaging](https://docs.plasmo.com/framework/messaging)
- [Storage](https://docs.plasmo.com/framework/storage)
- [Environment Variables](https://docs.plasmo.com/framework/env)
- [Import Resolution](https://docs.plasmo.com/framework/import)
- [Assets](https://docs.plasmo.com/framework/assets)
- [Icon](https://docs.plasmo.com/framework/icon)
- [Locales](https://docs.plasmo.com/framework/locales)
- [Remote Code](https://docs.plasmo.com/framework/remote-code)
- Customization




- [Principles](https://docs.plasmo.com/framework/customization)
- [Manifest Override](https://docs.plasmo.com/framework/customization/manifest)
- [Use src Directory](https://docs.plasmo.com/framework/customization/src)
- [Replace the HTML](https://docs.plasmo.com/framework/customization/html)
- [Alias Imports](https://docs.plasmo.com/framework/customization/alias)
- [Internal Paths](https://docs.plasmo.com/framework/customization/internal-path)

- Itero




- [Getting Started](https://docs.plasmo.com/itero)
- [TestBed](https://docs.plasmo.com/itero/test-bed)
- [Team](https://docs.plasmo.com/itero/team)
- [GitHub Extension Builder](https://docs.plasmo.com/itero/builder)
- [Publisher](https://docs.plasmo.com/itero/publisher)
- [MV2 to MV3](https://docs.plasmo.com/itero/mv2-to-mv3)
- [GitHub Integration](https://docs.plasmo.com/itero/github)
- [Manual API](https://docs.plasmo.com/itero/api)

- [Quickstarts](https://docs.plasmo.com/quickstarts)




- [Migrate to Plasmo](https://docs.plasmo.com/quickstarts/migrate-to-plasmo)
- [Quickstart: Next.js](https://docs.plasmo.com/quickstarts/with-nextjs)
- [Quickstart: Stripe](https://docs.plasmo.com/quickstarts/with-stripe)
- [Quickstart: Redux](https://docs.plasmo.com/quickstarts/with-redux)
- [Quickstart: Tailwind CSS](https://docs.plasmo.com/quickstarts/with-tailwindcss)
- [Quickstart: Supabase](https://docs.plasmo.com/quickstarts/with-supabase)
- [Quickstart: Firebase Auth](https://docs.plasmo.com/quickstarts/with-firebase-authentication)
- [Quickstart: Google Analytics](https://docs.plasmo.com/quickstarts/with-google-analytics)
- [Quickstart: Chrome Storage](https://docs.plasmo.com/quickstarts/with-chrome-storage)

- [Welcome](https://docs.plasmo.com/)
- Framework




- [Getting Started](https://docs.plasmo.com/framework)
- Workflows




- [New Extension](https://docs.plasmo.com/framework/workflows/new)
- [Development Server](https://docs.plasmo.com/framework/workflows/dev)
- [Production Build](https://docs.plasmo.com/framework/workflows/build)
- [Submission](https://docs.plasmo.com/framework/workflows/submit)
- [FAQ](https://docs.plasmo.com/framework/workflows/faq)

- [Extension Pages](https://docs.plasmo.com/framework/ext-pages)
- [Tab Pages](https://docs.plasmo.com/framework/tab-pages)
- [Sandbox Pages](https://docs.plasmo.com/framework/sandbox-pages)
- [Content Scripts](https://docs.plasmo.com/framework/content-scripts)
- [Content Scripts UI](https://docs.plasmo.com/framework/content-scripts-ui)




- [Life Cycle](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle)
  - [Terminologies](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#terminologies)
  - [Anchor](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#anchor)
  - [Root Container](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#root-container)
  - [Renderer](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#renderer)
- [Styling](https://docs.plasmo.com/framework/content-scripts-ui/styling)

- [Background SW](https://docs.plasmo.com/framework/background-service-worker)
- [Messaging](https://docs.plasmo.com/framework/messaging)
- [Storage](https://docs.plasmo.com/framework/storage)
- [Environment Variables](https://docs.plasmo.com/framework/env)
- [Import Resolution](https://docs.plasmo.com/framework/import)
- [Assets](https://docs.plasmo.com/framework/assets)
- [Icon](https://docs.plasmo.com/framework/icon)
- [Locales](https://docs.plasmo.com/framework/locales)
- [Remote Code](https://docs.plasmo.com/framework/remote-code)
- Customization




- [Principles](https://docs.plasmo.com/framework/customization)
- [Manifest Override](https://docs.plasmo.com/framework/customization/manifest)
- [Use src Directory](https://docs.plasmo.com/framework/customization/src)
- [Replace the HTML](https://docs.plasmo.com/framework/customization/html)
- [Alias Imports](https://docs.plasmo.com/framework/customization/alias)
- [Internal Paths](https://docs.plasmo.com/framework/customization/internal-path)

- Itero




- [Getting Started](https://docs.plasmo.com/itero)
- [TestBed](https://docs.plasmo.com/itero/test-bed)
- [Team](https://docs.plasmo.com/itero/team)
- [GitHub Extension Builder](https://docs.plasmo.com/itero/builder)
- [Publisher](https://docs.plasmo.com/itero/publisher)
- [MV2 to MV3](https://docs.plasmo.com/itero/mv2-to-mv3)
- [GitHub Integration](https://docs.plasmo.com/itero/github)
- [Manual API](https://docs.plasmo.com/itero/api)

- [Quickstarts](https://docs.plasmo.com/quickstarts)




- [Migrate to Plasmo](https://docs.plasmo.com/quickstarts/migrate-to-plasmo)
- [Quickstart: Next.js](https://docs.plasmo.com/quickstarts/with-nextjs)
- [Quickstart: Stripe](https://docs.plasmo.com/quickstarts/with-stripe)
- [Quickstart: Redux](https://docs.plasmo.com/quickstarts/with-redux)
- [Quickstart: Tailwind CSS](https://docs.plasmo.com/quickstarts/with-tailwindcss)
- [Quickstart: Supabase](https://docs.plasmo.com/quickstarts/with-supabase)
- [Quickstart: Firebase Auth](https://docs.plasmo.com/quickstarts/with-firebase-authentication)
- [Quickstart: Google Analytics](https://docs.plasmo.com/quickstarts/with-google-analytics)
- [Quickstart: Chrome Storage](https://docs.plasmo.com/quickstarts/with-chrome-storage)

System

On This Page

- [Terminologies](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#terminologies)
- [Anchor](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#anchor)
- [Overlay](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#overlay)
- [Update Position](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#update-position)
- [Inline](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#inline)
- [Root Container](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#root-container)
- [Custom DOM Mounting](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#custom-dom-mounting)
- [Closed Shadow Root](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#closed-shadow-root)
- [Custom Styles](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#custom-styles)
- [Custom Root Container](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#custom-root-container)
- [Renderer](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#renderer)
- [Detecting and Optimizing Root Container Removal](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#detecting-and-optimizing-root-container-removal)
- [Custom Renderer](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#custom-renderer)

[Question? Give us feedback → (opens in a new tab)](https://github.com/PlasmoHQ/docs/issues/new?title=Feedback%20for%20%E2%80%9CLife%20Cycle%20of%20Plasmo%20CSUI%E2%80%9D&labels=feedback) [Edit this page on GitHub](https://github.com/PlasmoHQ/docs/edit/main/src/pages/framework/content-scripts-ui/life-cycle.mdx)

Framework

[Content Scripts UI](https://docs.plasmo.com/framework/content-scripts-ui)

Life Cycle

# Life Cycle of Plasmo CSUI

Plasmo's CSUI orchestrates a lifecycle dedicated to mounting and unmounting your React, Vue, or Svelte components in a content script. Although each UI library/framework has a slightly different mounting API, the top-level lifecycle is largely the same:

1. Get an [`Anchor`](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#anchor)
2. Create or locate a [`Root Container`](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#root-container)
3. [Render](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle#renderer) the component onto the `Root Container`

## Terminologies [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#terminologies)

| Term | Description |
| :-- | :-- |
| Anchor | Tell CSUI how and where to mount your component |
| Anchor-getter | Tell CSUI how to find your anchor(s) |
| Overlay | Mount your component on a top-level (max z-index) overlay element |
| Inline | Mount your component into the webpage's DOM, next to a target element |
| Root Container | A ShadowDOM element created by CSUI to isolate your component |
| Renderer | The top-level life-cycle runner (it does everything) |

## Anchor [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#anchor)

![CSUI Life Cycle](https://docs.plasmo.com/_next/image?url=%2F_next%2Fstatic%2Fmedia%2F2022-12-02-23-53-02.210a103b.png&w=1920&q=75)

A Plasmo CSUI anchor is defined by the following type:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
export type PlasmoCSUIAnchor = {
  type: "overlay" | "inline"
  element: Element
}
```

By default, the CSUI lifecycle creates an overlay anchor using the `document.body` element:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
{
  type: "overlay",
  element: document.body
}
```

If any anchor-getter function is defined and exported, the CSUI lifecycle will use the returned element and the relevant anchor type instead. Since the anchor-getter functions can be async, you also have the power to control _when_ Plasmo mounts your component. For example, you can wait for a specific element to appear on the page before mounting your component.

The anchor is passed down to the CSUI via the anchor props. You can access it as follow:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoCSUIProps } from "plasmo"

const AnchorTypePrinter: FC<PlasmoCSUIProps> = ({ anchor }) => {
  return <span>{anchor.type}</span>
}

export default AnchorTypePrinter
```

### Overlay [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#overlay)

Overlay anchors spawn `CSUI Overlay Containers` which are batch-mounted onto a single `Root Container` element per CSUI. The `Overlay Containers` are absolutely positioned relative to each anchor's element with maxed out z-index. Then, your exported `CSUI Component` is mounted onto each `Overlay Container`:

![Overlay Anchor Mounting](https://docs.plasmo.com/_next/image?url=%2F_next%2Fstatic%2Fmedia%2F2022-12-02-22-45-32.fae5e567.png&w=1920&q=75)

To specify a single overlay anchor, export a `getOverlayAnchor` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetOverlayAnchor } from "plasmo"

export const getOverlayAnchor: PlasmoGetOverlayAnchor = async () =>
  document.querySelector("#pricing")
```

To specify a list of overlay anchors, export a `getOverlayAnchorList` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetOverlayAnchorList } from "plasmo"

export const getOverlayAnchorList: PlasmoGetOverlayAnchorList = async () =>
  document.querySelectorAll("a")
```

⚠️

`getOverlayAnchorList` does not cover dynamic case at the moment. For example,
if new anchors are added to the web page after the initial rendering, the CSUI
lifecycle will not be able to detect it. PR is welcome to improve this
feature!

#### Update Position [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#update-position)

The default `Overlay Container` listens to the window scroll event to align itself with the anchor element. You can customize how the `Overlay Container` refreshes its absolute positioning by exporting a `watchOverlayAnchor` function. The example below refreshes the position every 8472ms:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoWatchOverlayAnchor } from "plasmo"

export const watchOverlayAnchor: PlasmoWatchOverlayAnchor = (
  updatePosition
) => {
  const interval = setInterval(() => {
    updatePosition()
  }, 8472)

  // Clear the interval when unmounted
  return () => {
    clearInterval(interval)
  }
}
```

Check [with-content-scripts-ui/contents/plasmo-overlay-watch.tsx (opens in a new tab)](https://github.com/PlasmoHQ/examples/blob/main/with-content-scripts-ui/contents/plasmo-overlay-watch.tsx) for an example.

### Inline [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#inline)

Inline anchor embeds your `CSUI Component` directly into the web page. Each anchor spawns a `Root Container` appended next to its target element. Within each `Root Container`, an `Inline Container` is created which is then used to mount the exported `CSUI Component`:

![CSUI Inline Anchor](https://docs.plasmo.com/_next/image?url=%2F_next%2Fstatic%2Fmedia%2F2022-12-02-23-32-21.5d6a5e38.png&w=1920&q=75)

To specify a single inline anchor, export a `getInlineAnchor` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetInlineAnchor } from "plasmo"

export const getInlineAnchor: PlasmoGetInlineAnchor = async () =>
  document.querySelector("#pricing")
```

To specify single inline anchor with insert position:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetInlineAnchor } from "plasmo"

export const getInlineAnchor: PlasmoGetInlineAnchor = async () => ({
      element: document.querySelector("#pricing"),
      insertPosition: "afterend"
})
```

To specify a list of inline anchors, export a `getInlineAnchorList` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetInlineAnchorList } from "plasmo"

export const getInlineAnchorList: PlasmoGetInlineAnchorList = async () =>
  document.querySelectorAll("a")
```

To specify a list of inline anchors with insert position:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetInlineAnchorList } from "plasmo"

export const getInlineAnchorList: PlasmoGetInlineAnchorList = async () => {
  const anchors = document.querySelectorAll("a")
  return Array.from(anchors).map((element) => ({
    element,
    insertPosition: "afterend"
  }))
}
```

Check [with-content-scripts-ui/contents/plasmo-inline.tsx (opens in a new tab)](https://github.com/PlasmoHQ/examples/blob/main/with-content-scripts-ui/contents/plasmo-inline.tsx) for an example.

## Root Container [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#root-container)

![Root container creation](https://docs.plasmo.com/_next/image?url=%2F_next%2Fstatic%2Fmedia%2F2022-12-03-04-06-51.8891f047.png&w=1920&q=75)

The `Root Container` is where your `CSUI Component` is mounted. The built-in `Root Container` is a ShadowDOM element with the `plasmo-csui` custom tag. This allows you to style the `Root Container` and their exported components without being impacted by the web page's styles.

### Custom DOM Mounting [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#custom-dom-mounting)

The `Root Container` creates a `shadowHost` which gets injected into the web page's DOM tree. By default, Plasmo injects the `shadowHost` after the element for an inline anchor, and before the `document.body` for an overlay anchor. To customize this behavior, export a `mountShadowHost` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoMountShadowHost } from "plasmo"

export const mountShadowHost: PlasmoMountShadowHost = ({
  shadowHost,
  anchor,
  mountState
}) => {
  anchor.element.appendChild(shadowHost)
  mountState.observer.disconnect() // OPTIONAL DEMO: stop the observer as needed
}
```

### Closed Shadow Root [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#closed-shadow-root)

By default, the shadow root is "open," allowing anyone (developer and extension user) to inspect the hierarchy of the ShadowDOM. To override this behavior, export a `createShadowRoot` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoCreateShadowRoot } from "plasmo"

export const createShadowRoot: PlasmoCreateShadowRoot = (shadowHost) =>
  shadowHost.attachShadow({ mode: "closed" })
```

### Custom Styles [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#custom-styles)

The built-in ShadowDOM provides a convenient mechanism for extension developers to safely style their components by exporting a `getStyle` function that returns an [HTML style element (opens in a new tab)](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style).

For further guidance on styling CSUI, please read [Styling Plasmo CSUI](https://docs.plasmo.com/framework/content-scripts-ui/styling).

### Custom Root Container [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#custom-root-container)

Sometimes, you'll want to completely replace Plasmo's Shadow DOM container implementation to fit your needs. For example, you might want to piggyback on an element within the web page itself instead of creating a new DOM element. To do so, export a `getRootContainer` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetRootContainer } from "plasmo"

export const getRootContainer = () => document.getElementById("itero")
```

Some reasons you'd want to do this:

- The extension needs to [absorb the styling of the host webpage (opens in a new tab)](https://github.com/PlasmoHQ/plasmo/issues/10#issuecomment-1149499252)
- The extension needs to mount the component directly into the webpage instead of using a shadow DOM
- The extension needs to use an [iframe (opens in a new tab)](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe), instead

⚠️

If you export a `getRootContainer` function, any function that extends the
built-in ShadowDOM such as `getStyle` or `getShadowHostId` will be ignored.
Call those functions within your custom `getRootContainer` logic as needed!

Check [with-content-scripts-ui (opens in a new tab)](https://github.com/PlasmoHQ/examples/blob/main/with-content-scripts-ui/contents/plasmo-root-container.tsx) for an example.

## Renderer [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#renderer)

![Renderer mounting Component](https://docs.plasmo.com/_next/image?url=%2F_next%2Fstatic%2Fmedia%2F2022-12-03-13-15-13.4b207c61.png&w=1920&q=75)

The `Renderer` is in charge of observing the website's DOM to detect the presence of each `Root Container` and tracking the linking between each anchor's element and its `Root Container`. Once a stable `Root Container` is determined, the `Renderer` mounts the exported `CSUI Component` into the `Root Container` using either an `Inline Container` or an `Overlay Container`, depending on the type of the `Anchor`.

### Detecting and Optimizing Root Container Removal [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#detecting-and-optimizing-root-container-removal)

When a webpage changes its DOM structure, the `Root Container` might be removed. For example, given an email client filled with inbox items, and a CSUI injected inline next to each item. When an item is deleted, the root container will be removed as well.

To detect `Root Container` removal, the `CSUI Renderer` compares each mounted container's root against the `window.document` object. This check can be optimized to O(1) by exporting a `getShadowHostId` function:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetShadowHostId } from "plasmo"

export const getShadowHostId: PlasmoGetShadowHostId = () => `adonais`
```

The function also allows developers to customize the id for each anchor found:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoGetShadowHostId } from "plasmo"

export const getShadowHostId: PlasmoGetShadowHostId = ({ element }) =>
  element.getAttribute("data-custom-id") + `-pollax-iv`
```

### Custom Renderer [Permalink for this section](https://docs.plasmo.com/framework/content-scripts-ui/life-cycle\#custom-renderer)

Developers may export a `render` function to override the default renderer. You might need this ability to:

- Provide a custom `Inline container` or `Overlay container`
- Customize the mounting logic
- Provide a custom `MutationObserver`

For example, to use an existing element as a custom container:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoRender } from "plasmo"

import { CustomContainer } from "~components/custom-container"

const EngageOverlay = () => <span>ENGAGE</span>

// This function overrides the default `createRootContainer`
export const getRootContainer = () =>
  new Promise((resolve) => {
    const checkInterval = setInterval(() => {
      const rootContainer = document.getElementById("itero")
      if (rootContainer) {
        clearInterval(checkInterval)
        resolve(rootContainer)
      }
    }, 137)
  })

export const render: PlasmoRender = async ({
  anchor, // the observed anchor, OR document.body.
  createRootContainer // This creates the default root container
}) => {
  const rootContainer = await createRootContainer()

  const root = createRoot(rootContainer) // Any root
  root.render(
    <CustomContainer>
      <EngageOverlay />
    </CustomContainer>
  )
}
```

How to dynamically create a custom container:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoRender } from "plasmo"

import { CustomContainer } from "~components/custom-container"

const EngageOverlay = () => <span>ENGAGE</span>

// This function overrides the default `createRootContainer`
export const getRootContainer = ({ anchor, mountState }) =>
  new Promise((resolve) => {
    const checkInterval = setInterval(() => {
      let { element, insertPosition } = anchor
      if (element) {
        const rootContainer = document.createElement("div")
        mountState.hostSet.add(rootContainer)
        mountState.hostMap.set(rootContainer, anchor)
        element.insertAdjacentElement(insertPosition, rootContainer)
        clearInterval(checkInterval)
        resolve(rootContainer)
      }
    }, 137)
  })

export const render: PlasmoRender = async ({
  anchor, // the observed anchor, OR document.body.
  createRootContainer // This creates the default root container
}) => {
  const rootContainer = await createRootContainer(anchor)

  const root = createRoot(rootContainer) // Any root
  root.render(
    <CustomContainer>
      <EngageOverlay />
    </CustomContainer>
  )
}
```

To utilize the built-in `Inline Container` or `Overlay Container`:

```nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10
import type { PlasmoRender } from "plasmo"

const AnchorOverlay = ({ anchor }) => <span>{anchor.innerText}</span>

export const render: PlasmoRender = async (
  {
    anchor, // the observed anchor, OR document.body.
    createRootContainer // This creates the default root container
  },
  _,
  OverlayCSUIContainer
) => {
  const rootContainer = await createRootContainer()

  const root = createRoot(rootContainer) // Any root
  root.render(
    // You must pass down an anchor to mount the default container. Here we pass the default one
    <OverlayCSUIContainer anchor={anchor}>
      <AnchorOverlay anchor={anchor} />
    </OverlayCSUIContainer>
  )
}
```

If you need to customize the MutationObserver, do not export an anchor-getter function. Otherwise, the built-in MutationObserver will still be spawned.

[Content Scripts UI](https://docs.plasmo.com/framework/content-scripts-ui "Content Scripts UI") [Styling](https://docs.plasmo.com/framework/content-scripts-ui/styling "Styling")

System

* * *

[© 2025 Plasmo Corp. All rights reserved. v0.4.0](https://www.plasmo.com/)